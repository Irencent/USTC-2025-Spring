"0","library(dplyr)"
"0","library(factoextra)"
"0",""
"0","df_2019 <- happiness_all %>%"
"0","  filter(Year == 2019) %>%"
"0","  select(Country, GDP, SocialSupport, Health, Freedom, Generosity, Trust) %>%"
"0","  drop_na()"
"0",""
"0","# å°†å›½å®¶åè®¾ä¸ºè¡Œåï¼ˆä»…ç”¨äºèšç±»ï¼‰"
"0","rownames(df_2019) <- df_2019$Country"
"2","G2;H2;Warningh: Setting row names on a tibble is deprecated.g
"
"0","data_for_cluster <- df_2019 %>% select(-Country)"
"0",""
"0","data_scaled <- scale(data_for_cluster)  # Z-score æ ‡å‡†åŒ–"
"0",""
"0","set.seed(42)  # å¯é‡å¤æ€§"
"0","k <- 4  # è®¾ç½®åˆ†ä¸º4ç±»ï¼ˆä½ å¯å°è¯• 3ã€5ã€6 ç­‰ï¼‰"
"0","kmeans_result <- kmeans(data_scaled, centers = k)"
"0",""
"0","# å°†èšç±»ç»“æœåŠ å…¥åŸè¡¨æ ¼"
"0","df_2019$Cluster <- as.factor(kmeans_result$cluster)"
"0",""
"0","fviz_cluster(kmeans_result,"
"0","             data = data_scaled,"
"0","             geom = ""point"","
"0","             labelsize = 10,"
"0","             main = ""2019å¹´å›½å®¶å¹¸ç¦ç‰¹å¾èšç±»"","
"0","             repel = TRUE)"
"0",""
