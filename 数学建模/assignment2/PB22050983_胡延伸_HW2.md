# 数学建模作业二

## 胡延伸 PB22050983


#### 1. 问题描述与约束分析

**输入条件**：
- **时间资源**：周一至周五每天5个教学时间段，共25个时间段。
- **课程与教师**：共\(n\)门课程，由\(m\)位教师讲授。每位教师授课1-3门，周总工作量≤5个时间段；每门课程周授课次数\(c_i \in \{1,2,3\}\)，且由一位教师独立负责。设所有课程周总授课次数为\(S = \sum_{i=1}^n c_i\).
- **排课约束**：

    1. 每门课程每天至多安排一次。
    2. 相邻两次授课至少间隔一天。
    3. 同一时间段内，不同课程需占用不同教室。
- **教师工作量约束**：
    1. 每位教师总授课次数不超过5。因此，总需求\(S \leq 5m\)
    2. 由于每位教师最多交 3 门课，因此总课程数满足: \(3m \ge n\), 即\(m \ge \left\lceil \frac{n}{3} \right\rceil\)


**优化目标**：最小化教室数量\(R\)，即所有时间段中所需教室数的最大值。

---

#### 2. 数学模型与理论下限

**总需求与教室下限**：
由于每个时间段最多被使用 $R$ 次（即该时间段安排的课程数），故总需求:\[S \le 25R\]

因此，教室数量的下限为：
\[
R_{\text{min}} = \left\lceil \frac{S}{25} \right\rceil
\]
该下限成立的充分条件是存在一种排课方案，使得每个时间段内课程数不超过\(R_{\text{min}}\)，且满足所有约束。

---

#### 3. 分阶段排课算法

为逼近理论下限，提出以下两阶段排课策略：

**阶段一：课程的天分配**

1. **固定间隔分配**：
   • \(c_i = 3\)的课程分配至周一、周三、周五。
   • \(c_i = 2\)的课程分配至非连续天（如周一与周三、周二与周四等）。
   • \(c_i = 1\)的课程可分配至任意天。

2. **冲突检测**：确保同一教师的多门课程不在同一天。
   
3. 遍历所有时间段 \( t \in \{1,2,...,25\} \)，统计每个时间段分配的课程数 \( N_t \)。若存在 \( N_t > R_{\text{current}} \)（当前尝试的教室数，初始值为 \( R_{\text{min}} \)），则触发调整。
   - **冲突类型分类**：
      - **教师冲突**：同一教师在某一时间段被分配多门课程。
      - **教室过载**：同一时间段课程数超过 \( R_{\text{current}} \)。

**阶段二：时间段分配​**

1. **贪心策略**：
   • 按\(c_i\)从大到小排序课程，优先处理约束严格的课程。
   • 对每门课程的每次授课，选择当前占用率最低的时间段，并避开同一教师的其他课程时段。

2. **动态调整**
    - **冲突课程筛选**:从过载时间段 \( t \) 中筛选可调整的课程，优先选择约束较弱的课程：
      1. **授课次数少的课程**（如 \( c_i=1 \) 的课程）。
      2. **时间段灵活性高的课程**（如该课程的其他授课时段尚未固定）。
      3. **无教师冲突的课程**（优先调整不引发教师冲突的课程）。
  • 排除无法调整的课程（如该课程的所有可能时段均已被占用）。


   - **回溯式时段重分配**
     - **单课程调整**：
       1. 对选定的课程 \( C \)，从其可用的其他时段集合 \( T_{\text{available}} \) 中选择一个时段 \( t' \)，使得：
          ◦ \( t' \) 所在天未被 \( C \) 占用（满足每天至多一次）。
          ◦ \( t' \) 与 \( C \) 的其他授课时段间隔至少一天。
          ◦ 教师在该时段 \( t' \) 无其他课程。
          ◦ \( N_{t'} < R_{\text{current}} \)。
       2. 若找到满足条件的 \( t' \)，将 \( C \) 从 \( t \) 移至 \( t' \)，更新 \( N_t \) 和 \( N_{t'} \)。

     - **多课程链式调整**：
       - 若直接移动 \( C \) 导致 \( t' \) 过载或引发新冲突，需递归调整影响链。例如：
         ◦ 移动 \( C \) 至 \( t' \) → \( t' \) 过载 → 选择 \( t' \) 中的另一门课程 \( C' \) 移至 \( t'' \)。

   - **约束维护与可行性验证**
      - **硬约束检查**：
     • 每门课程每天至多一个时段。
     • 同一教师不同课程时段不重叠。
     • 课程间隔至少一天（如周一与周三允许，周二与周三禁止）。
     
      - **终止条件**：
     • 成功：所有 \( N_t \leq R_{\text{current}} \) 且无约束冲突。
     • 失败：无法在有限步骤内找到可行解 → 提升 \( R_{\text{current}} \) 至 \( R_{\text{current}}+1 \)，重新运行阶段二。


---

#### 6. 结论

本研究证明了在教师工作量与课程间隔约束下，教室数量的理论下限为\(\lceil S/25 \rceil\)，并提出一种高效的两阶段排课算法。通过合理分配天和时间段资源，可实际达到该下限，显著优化教室使用效率。未来工作可扩展至多教室类型或动态课程需求场景。

